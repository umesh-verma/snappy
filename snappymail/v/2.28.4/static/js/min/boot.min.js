(e=>{const t=t=>e.location.pathname.replace(/\/+$/,"")+"/?/"+t,a=t=>e.getElementById("rl-"+t),r="1"==a("app")?.dataset?.admin,o=e=>{a("loading").hidden=!0,e.hidden=!1},n=e=>{let t=a("loading-error");t.append(e),o(t)},s=t=>t?new Promise(((a,r)=>{const o=e.createElement("script");o.onload=()=>a(),o.onerror=()=>r("Failed loading "+t),o.src=t,e.head.append(o)})):Promise.reject("src is empty");try{let t=e.cookie.match(/(^|;) ?smctoken=([^;]+)/);if(t=t?t[2]:localStorage.getItem("smctoken"),!t){let e=new Uint8Array(16);crypto.getRandomValues(e),t=encodeURIComponent(btoa(String.fromCharCode(...e)))}localStorage.setItem("smctoken",t),e.cookie="smctoken="+t+";path=/;samesite=strict"}catch(e){}let i={};window.rl={adminArea:()=>r,settings:{get:e=>i[e],set:(e,t)=>i[e]=t,app:e=>i.System[e]},setTitle:t=>e.title=(t||"")+(i.title?(t?" - ":"")+i.title:""),setData:e=>{i=e,rl.app.refresh()},loadScript:s,fetch:(e,t,a)=>{t=Object.assign({mode:"same-origin",cache:"no-cache",redirect:"error",referrerPolicy:"no-referrer",credentials:"same-origin",headers:{}},t);let r=1,o=i.System?.token,n={};return a&&(t.method="POST",a instanceof FormData&&(a.forEach(((e,t)=>{e instanceof File?r=0:Reflect.has(n,t)?(Array.isArray(n[t])||(n[t]=[n[t]]),n[t].push(e)):n[t]=e})),r?a=n:o&&a.set("XToken",o)),r&&(t.headers["Content-Type"]="application/json",a=JSON.stringify(a)),t.body=a),o&&(t.headers["X-SM-Token"]=o),fetch(e,t)},fetchJSON:(e,t,a)=>((t=Object.assign({headers:{}},t)).headers.Accept="application/json",rl.fetch(e,t,a).then((e=>e.ok?e.json():Promise.reject("Network response error: "+e.status))))},navigator.cookieEnabled?[].flat?rl.fetchJSON(t(`${r?"Admin":""}AppData/0/${Math.random().toString().slice(2)}/`)).then((a=>{i=a;const o=a.StaticLibsJs,c=()=>rl.app.bootstart();s(o).then((()=>s(o.replace("/libs.",`/${r?"admin":"app"}.`)))).then((()=>a.PluginsLink?s(t(a.PluginsLink)):Promise.resolve())).then((()=>rl.app?c():e.addEventListener("readystatechange",(()=>"complete"==e.readyState&&c())))).catch((e=>{throw n(e),e}))})).catch((e=>n(e))):o(a("BadBrowser")):o(a("NoCookie"))})(document);
